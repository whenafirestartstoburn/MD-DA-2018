Файл forbes.htm содержит список богатейших американцев по версии журнала Форбс. На его примере потренируемся в разборе html страниц.

# Задание 1

Используйте команду readLines для загрузки файла в текстовый вектор html.
Сколько строк в файле?
Сколько символов в файле?

```{r}
forbes <- readLines('https://raw.githubusercontent.com/SergeyMirvoda/MD-DA-2018/master/data/forbes.htm')
length(forbes) #1991
sum(nchar(forbes)) #80380
```

Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.

Напишите шаблон регулярного выражения и используйте функцию grep, чтобы извлечь размер дохода из данных в векторе html. Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть информация о доходе, а не просто первый попавшийся текст.

```{r}
regex <- "\\t+<td\\sclass=\"worth\">\\$((\\d+)|(\\d+,\\d+))\\sB</td>$"
worths <- grep(regex, forbes, value = TRUE)
# ровно 100 строк
```

Напишите код, использовав регулярное выражение из п. 3, и функции regexp и regmatches, чтобы извлечь все данные о доходе. 
```{r}
regexData <- regexpr("\\$((\\d+)|(\\d+,\\d+))\\s", worths)
regmatchesData <- regmatches(worths, regexData)
```

Проверьте следующее:

- Должно быть ровно сто значений (там их 100)
- Самый большой доход должен быть доход Билла Гейтса

```{r}
regmatchesData[1] # 72 млрд Билла Гейста
```
- Такой доход должен быть в списке один раз.

```{r}
length(grep("$72",regmatchesData,fixed = TRUE)) == 1 # TRUE
```
- В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
```{r}
length(grep("$41",regmatchesData,fixed = TRUE)) != 0 # TRUE
```
- Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
valuesCount <- 0
for(val1 in regmatchesData) {
  for(val2 in regmatchesData) {
    if(val1==val2) {
      valuesCount <- valuesCount+1
    }
  }
  if(valuesCount == 2)
    break
}
print(valuesCount) # 2
```

# Задание 2

В данных доход представлен в формате "$42 B", что означает 42 ?? 10^9. Преобразуйте этот формат в числовой и сохраните в вектор worths. 

```{r}
tmp <- regexpr("(\\d+|,\\d+)", regmatchesData)
tmp <- regmatches(regmatchesData, tmp)
worths <- as.double(tmp) * 1e9
```


Удостоверьтесь в следующем:

- worths является вектором и в нём сто занчений типа double.

```{r}
is.vector(worths)
is.double(worths)
length(worths)
```

- Все элементы вектора worths больше 1 миллиарда.

```{r}
all(worths) > 1e9
```

- Самое большое число это доход Билла Гейтса

```{r}
max(worths) == 72e9
```

Используйте вектор worths , чтобы выяснить следующее:

- Какова медиана ста этих записей?

```{r}
median(worths) #8
```

- Средний доход?

```{r}
mean(worths)
```

- Как много людей из этого списка имеют доход больше 5млрд., 10, 25?

```{r}
sum(worths>5e9)
sum(worths>10e9)
sum(worths>25e9)
```
- Какой их общий доход?

```{r}
worthsSum <- sum(worths)
worthsSum
```

- Какую долю от общего дохода составляет пятёрка самых богатых?

```{r}
sum(worths[1:5])/worthsSum
```

- В данных федерального резерва США найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей.

```{r}
household.net.worth<-76824.5e+09
worthsSum/household.net.worth
```

